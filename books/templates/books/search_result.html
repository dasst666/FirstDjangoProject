{% extends 'books/base.html' %}

{% block content %}
<div class="container mt-4">
  <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Ñ–æ—Ä–º–∞ -->
  <form method="get" action="{% url 'book-search' %}" class="d-flex justify-content-center mb-4">
    <input type="text" name="q" class="form-control me-2 w-50" placeholder="–ù–∞–π—Ç–∏ –∫–Ω–∏–≥—É..." value="{{ request.GET.q }}">
    <button type="submit" class="btn btn-success">üîç –ü–æ–∏—Å–∫</button>
  </form>

  {% if local_results %}
    <h4 class="mt-5">üìö –ù–∞–π–¥–µ–Ω–æ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ:</h4>
    <div class="row row-cols-2 row-cols-md-4 g-4">
      {% for book in local_results %}
        <div class="col">
          <div class="card h-100 shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">{{ book.title }}</h5>
              <p class="card-text"><small class="text-muted">{{ book.author }}</small></p>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% if results %}
    <h4 class="text-center">üåê –ù–∞–π–¥–µ–Ω–æ –≤–æ –≤–Ω–µ—à–Ω–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ:</h4>
    <div class="row row-cols-2 row-cols-md-4 g-4">
      {% for book in results %}
        <div class="col">
          <div class="card h-100 shadow-sm">
            {% if book.image %}
              <img src="{{ book.image }}" class="card-img-top img-fluid" style="max-height: 200px; width: auto; margin: 0 auto; display: block;" alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏">
            {% endif %}
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ book.title }}</h5>
              <p class="card-text"><small class="text-muted">{{ book.author }}</small></p>
              <form method="post" action="{% url 'import-book' %}" class="mt-auto">
                {% csrf_token %}
                <input type="hidden" name="title" value="{{ book.title }}">
                <input type="hidden" name="author" value="{{ book.author }}">
                <input type="hidden" name="summary" value="{{ book.description }}">
                <input type="hidden" name="image" value="{{ book.image }}">
                <button type="submit" class="btn btn-primary btn-sm w-100 mt-2">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% elif not local_results %}
    <p class="text-center mt-4">üòî –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
  {% endif %}
</div>
{% endblock %}
