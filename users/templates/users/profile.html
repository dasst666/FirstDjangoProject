{% extends 'books/base.html' %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2> –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å: {{ user.username }}</h2>
    <form method="POST" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-outline-danger btn-sm">–í—ã–π—Ç–∏</button>
    </form>
  </div>
  <a href="{% url 'book-search' %}" class="btn btn-success btn-sm">
    –ü–æ–∏—Å–∫ –∫–Ω–∏–≥
  </a>  
  <!-- –ü–æ–ª–∫–∞: –ü—Ä–æ—á–∏—Ç–∞–Ω–æ -->
  <h4 class="mt-4">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</h4>
  <div class="row row-cols-2 row-cols-md-4 g-4">
    {% for user_book in books_read %}
      <div class="col">
        <div class="card h-100 shadow-sm">
          {% if user_book.book.image_url %}
            <a href="{% url 'book-detail' pk=user_book.book.pk %}">
              <img src="{{ user_book.book.image_url }}" class="card-img-top img-fluid" style="max-height: 200px; object-fit: contain;" alt="–û–±–ª–æ–∂–∫–∞">
            </a>
            {% endif %}
          <div class="card-body text-center">
            <h6 class="card-title">{{ user_book.book.title }}</h6>
            <p class="card-text"><small class="text-muted">{{ user_book.book.author }}</small></p>
            <a href="{% url 'book-detail' pk=user_book.book.pk %}" class="btn btn-outline-primary btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-muted">–ù–µ—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥.</p>
    {% endfor %}
  </div>

  <!-- –ü–æ–ª–∫–∞: –ß–∏—Ç–∞—é -->
  <h4 class="mt-5">–°–µ–π—á–∞—Å —á–∏—Ç–∞—é</h4>
  <div class="row row-cols-2 row-cols-md-4 g-4">
    {% for user_book in books_reading %}
      <div class="col">
        <div class="card h-100 shadow-sm">
          {% if user_book.book.image_url %}
            <a href="{% url 'book-detail' pk=user_book.book.pk %}">
              <img src="{{ user_book.book.image_url }}" class="card-img-top img-fluid" style="max-height: 200px; object-fit: contain;" alt="–û–±–ª–æ–∂–∫–∞">
            </a>
            {% endif %}
          <div class="card-body text-center">
            <h6 class="card-title">{{ user_book.book.title }}</h6>
            <p class="card-text"><small class="text-muted">{{ user_book.book.author }}</small></p>
            <a href="{% url 'book-detail' pk=user_book.book.pk %}" class="btn btn-outline-primary btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-muted">–ù–µ—Ç –∫–Ω–∏–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —á—Ç–µ–Ω–∏—è.</p>
    {% endfor %}
  </div>

  <!-- –ü–æ–ª–∫–∞: –ë—É–¥—É —á–∏—Ç–∞—Ç—å -->
  <h4 class="mt-5">–ü–ª–∞–Ω–∏—Ä—É—é –ø—Ä–æ—á–∏—Ç–∞—Ç—å</h4>
  <div class="row row-cols-2 row-cols-md-4 g-4">
    {% for user_book in books_want %}
      <div class="col">
        <div class="card h-100 shadow-sm">
          {% if user_book.book.image_url %}
            <a href="{% url 'book-detail' pk=user_book.book.pk %}">
              <img src="{{ user_book.book.image_url }}" class="card-img-top img-fluid" style="max-height: 200px; object-fit: contain;" alt="–û–±–ª–æ–∂–∫–∞">
            </a>
              {% endif %}
          <div class="card-body text-center">
            <h6 class="card-title">{{ user_book.book.title }}</h6>
            <p class="card-text"><small class="text-muted">{{ user_book.book.author }}</small></p>
            <p class="card-text">
              <small class="text-muted">
                {% for genre in user_book.book.genres.all %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </small>
            </p>
            <a href="{% url 'book-detail' pk=user_book.book.pk %}" class="btn btn-outline-primary btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-muted">–ù–µ—Ç –∫–Ω–∏–≥ –≤ —Å–ø–∏—Å–∫–µ "–ë—É–¥—É —á–∏—Ç–∞—Ç—å".</p>
    {% endfor %}
  </div>

  <div class="text-center mt-5">
    <a href="{% url 'book-list' %}" class="btn btn-secondary">üìñ –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>
  </div>
</div>
{% endblock %}
